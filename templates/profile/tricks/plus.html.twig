{% extends 'base.html.twig' %}

{% block title %}Modifier un trick
{% endblock %}

{% block body %}
	<section
		class="relative pb-12 ">
		<!-- Hero image -->
		<div class="absolute inset-0">
			<img src="{{ asset('assets/images/image-cover.jpg') }}" alt="Hero" class="w-full h-[400px] sm:h-[500px] md:h-[600px] object-cover brightness-75">
			<div class="absolute inset-0 bg-gradient-to-b from-transparent to-white/80"></div>
		</div>

		<div class="relative z-10 container mx-auto px-4 sm:px-6 md:px-12 lg:px-20 xl:px-32 pt-20 mb-[42px] mt-[100px]">
			<div
				class="bg-white rounded-xl shadow-lg max-w-6xl mx-auto overflow-hidden pb-12">


				{# Flash messages #}
				{% for label, messages in app.flashes %}
					{% for message in messages %}
						<div class="p-4 mb-4 rounded bg-green-100 text-green-800">
							{{ message }}
						</div>
					{% endfor %}
				{% endfor %}
				{{ form_start(form, { attr: { novalidate:'novalidate', enctype:'multipart/form-data' } }) }}

				<!-- HERO IMAGE UPLOAD -->
				<div
					class="mb-[42px]">
					<!-- Featured Image Container -->
					<div
						id="image-container" class="w-full aspect-video border-2  rounded-t-xl flex items-center justify-center cursor-pointer overflow-hidden relative transition-all duration-300 hover:border-blue-400 hover:bg-gray-50 bg-[#E5E6EA]">

						{# Aperçu image #}
						<img
						id="image-preview" class="absolute inset-0 w-full h-full object-cover object-center opacity-0 transition-opacity duration-300"/>

						{# Placeholder #}
						<span id="image-placeholder" class="absolute text-gray-500 transition-opacity duration-300">
							Cliquez pour ajouter une image
						</span>

						{# Overlay texte/hero (facultatif) #}
						<div class="bg-[#00214D]/50 backdrop-blur-sm p-6 md:p-10 rounded-xl max-w-xl text-center pointer-events-none">
							<h1 class="text-white font-bold uppercase mb-4 text-4xl">Nouvel figure</h1>
							<p class="text-white text-2xl">Modifier la figure</p>
						</div>

						{# Champ file Symfony #}
						{{ form_widget(form.featuredImage, { 
            attr: { 
                class: 'absolute w-full h-full opacity-0 cursor-pointer', 
                accept: 'image/png, image/jpeg, image/webp' 
            } 
        }) }}

						{# Actions Edit/Delete #}
						<div class="absolute top-2 right-2 flex gap-2 opacity-0 transition-opacity duration-300" id="image-actions">
							<button type="button" id="edit-image" class="p-2 rounded  bg-[#1b84ff] hover:bg-[#056ee9] text-white">
								<i class="bi bi-pencil"></i>
								<span class="sr-only">Edit</span>
							</button>
							<button type="button" id="delete-image" class="p-2 rounded border-[#f8285a] bg-[#f8285a]  text-white hover:bg-[#d81a48]">
								<i class="bi bi-trash"></i>
								<span class="sr-only">Delete</span>
							</button>
						</div>

						{# Erreur validation #}
						<div id="image-error" class="absolute bottom-2 left-2 text-red-500 text-sm">
							{{ form_errors(form.featuredImage) }}
						</div>


					</div>
				</div>


				{# Prototypes Symfony pour ajout dynamique #}
				{% set imagePrototype %}
				<div class="media-item media-image flex-shrink-0 w-40 snap-start relative">
					<div class="mb-3 w-full aspect-video rounded overflow-hidden border relative">
						<img class="image-preview hidden w-full h-full object-cover object-center"/>
						<div class="image-placeholder absolute inset-0 bg-gray-100 flex items-center justify-center rounded border">
							<i class="bi bi-image text-2xl text-gray-400"></i>
						</div>
					</div>
					<input type="hidden" class="removed-image" name="removed_images[]">
					<div class="media-actions flex justify-end gap-2 mt-2">
						<div class="flex flex-row-reverse items-center gap-2">
							<button type="button" class="remove-item p-2 rounded border  border-[#f8285a] bg-white  text-[#f8285a] hover:bg-[#f8285a] hover:text-white">
								<i class="bi bi-x-square-fill"></i>
							</button>
							<button type="button" class="item-add p-2 rounded border border-[#1b84ff]  bg-white hover:bg-[#1b84ff] hover:text-white text-[#1b84ff]  transition">
								<i class="bi bi-plus-square-fill"></i>
							</button>
							<button type="button" class="item-edit p-2  rounded  bg-[#e9f3ff] hover:bg-[#1b84ff] hover:text-white text-[#1b84ff] transition hidden ">
								<i class="bi bi-plus-square-fill"></i>
							</button>
							<button type="button" class="item-close p-2 rounded border border-[#f6c000]  bg-white hover:bg-[#f6c000] hover:text-white text-[#f6c000] transition hidden">
								<i class="bi bi-eye-slash-fill"></i>
							</button>
							{{ form_widget(form.images.vars.prototype.file, {
    attr: {
        class: 'item-input h-10 w-0 opacity-0 transition-all duration-300 border rounded px-3 text-sm file:h-full file:border-0 file:bg-transparent',
        accept: 'image/png,image/jpeg,image/webp'
    }
}) }}

						</div>
					</div>

					<div class="text-[#f8285a] text-sm">
						{{ form_errors(form.images.vars.prototype.file) }}
					</div>

				</div>
				{% endset %}

				{% set videoPrototype %}
				<div class="media-item media-video flex-shrink-0 w-40 snap-start relative ">
					<div class="mb-3 w-full aspect-video rounded border relative">
						<iframe class="hidden w-full h-full rounded border" frameborder="0" allowfullscreen></iframe>
						<div class="video-placeholder absolute inset-0 bg-gray-100 flex items-center justify-center rounded border">
							<i class="bi bi-play-btn text-3xl text-gray-400"></i>
						</div>
					</div>
					<input type="hidden" class="removed-video" name="removed_videos[]">
					<div class="media-actions flex justify-end gap-2 mt-2">
						<div class="flex flex-row-reverse items-center gap-2">
							<button type="button" class="remove-item p-2 rounded border  border-[#f8285a] bg-white  text-[#f8285a] hover:bg-[#f8285a] hover:text-white">
								<i class="bi bi-x-square-fill"></i>
							</button>
							<button type="button" class="item-add p-2  rounded border border-[#1b84ff]  bg-white hover:bg-[#1b84ff] hover:text-white text-[#1b84ff]   transition">
								<i class="bi bi-plus-square-fill"></i>
							</button>
							<button type="button" class="item-edit p-2  rounded border border-[#1b84ff]  bg-white hover:bg-[#1b84ff] hover:text-white text-[#1b84ff] transition hidden">
								<i class="bi bi-plus-square-fill"></i>
							</button>
							<button type="button" class="item-close p-2 rounded border border-[#f6c000]  bg-white hover:bg-[#f6c000] hover:text-white text-[#f6c000] transition hidden">
								<i class="bi bi-eye-slash-fill"></i>
							</button>
							{{ form_widget(form.videos.vars.prototype.url, {
                                attr: { class: 'item-input w-0 opacity-0 transition-all duration-300 border rounded px-3 py-2', placeholder: 'Lien YouTube' }
                            }) }}
						</div>
					</div>

					<div class="text-[#f8285a] text-sm">
						{{ form_errors(form.videos.vars.prototype.url) }}
					</div>
				</div>
				{% endset %}

				<div id="image-prototype" class="hidden" data-prototype="{{ imagePrototype|e('html_attr') }}"></div>
				<div id="video-prototype" class="hidden" data-prototype="{{ videoPrototype|e('html_attr') }}"></div>

				{# ----------------- CAROUSEL ----------------- #}
				<div class="relative w-full px-4 md:px-8 lg:px-8 overflow-hidden ">
					<div
						id="media-wrapper" class="flex gap-4 overflow-x-auto scroll-smooth snap-x snap-mandatory">
						{# Images existantes #}
						<div class="media-item media-image flex-shrink-0 w-40 snap-start relative">
							<div class="mb-3 w-full aspect-video rounded overflow-hidden border relative">
								<img class="image-preview hidden w-full h-full object-cover object-center"/>
								<div class="image-placeholder absolute inset-0 bg-gray-100 flex items-center justify-center rounded border">
									<i class="bi bi-image text-2xl text-gray-400"></i>
								</div>
							</div>
							<input type="hidden" class="removed-image" name="removed_images[]">
							<div class="media-actions flex justify-end gap-2 mt-2">
								<div class="flex flex-row-reverse items-center gap-2">
									<button type="button" class="remove-item p-2 rounded border  border-[#f8285a] bg-white  text-[#f8285a] hover:bg-[#f8285a] hover:text-white">
										<i class="bi bi-x-square-fill"></i>
									</button>
									<button type="button" class="item-add p-2 rounded border border-[#1b84ff]  bg-white hover:bg-[#1b84ff] hover:text-white text-[#1b84ff]  transition">
										<i class="bi bi-plus-square-fill"></i>
									</button>
									<button type="button" class="item-edit p-2  rounded  bg-[#e9f3ff] hover:bg-[#1b84ff] hover:text-white text-[#1b84ff] transition hidden ">
										<i class="bi bi-plus-square-fill"></i>
									</button>
									<button type="button" class="item-close p-2 rounded border border-[#f6c000]  bg-white hover:bg-[#f6c000] hover:text-white text-[#f6c000] transition hidden">
										<i class="bi bi-eye-slash-fill"></i>
									</button>
									{{ form_widget(form.images.vars.prototype.file, {
    attr: {
        class: 'item-input h-10 w-0 opacity-0 transition-all duration-300 border rounded px-3 text-sm file:h-full file:border-0 file:bg-transparent',
        accept: 'image/png,image/jpeg,image/webp'
    }
}) }}

								</div>
							</div>

							<div class="text-[#f8285a] text-sm">
								{{ form_errors(form.images.vars.prototype.file) }}
							</div>

						</div>

						{# Vidéos existantes #}
						{% for videoForm in form.videos %}
							<div class="media-item media-video flex-shrink-0 w-40 snap-start relative">
								<div class="video-container mb-3 w-full aspect-video rounded border relative">
									<iframe src="{{ videoForm.vars.data.getEmbedUrl()|default('') }}" class="w-full h-full rounded border" frameborder="0" allowfullscreen></iframe>
									<div class="video-placeholder bg-gray-100 w-full h-full flex items-center justify-center rounded border absolute inset-0 {{ videoForm.vars.data.getEmbedUrl() ? 'hidden' : '' }}">
										<i class="bi bi-play-btn text-3xl text-gray-400"></i>
									</div>
								</div>
								<input type="hidden" class="removed-video" name="removed_videos[]">
								<div class="media-actions flex justify-end gap-2 mt-2">

									<div class="flex flex-row-reverse items-center gap-2">
										<button type="button" class="remove-item p-2 rounded   border-[#f8285a] bg-[#f8285a]  text-white hover:bg-[#d81a48]">
											<i class="bi bi-trash "></i>
										</button>


										<button type="button" class="item-add p-2 rounded   bg-[#1b84ff] hover:bg-[#056ee9] transition hidden">
											<i class="bi bi-pencil  text-white"></i>
										</button>
										<button type="button" class="item-edit p-2 rounded   bg-[#1b84ff]  hover:bg-[#056ee9]  transition hidden">
											<i class="bi bi-pencil text-white"></i>
										</button>
										<button type="button" class="item-close p-2 rounded   bg-[#f6c000]  hover:bg-[#dead00] transition hidden">
											<i class="bi bi-eye-slash text-white"></i>
										</button>

										{{ form_widget(videoForm.url, {
                 attr: {
            class: 'item-input w-0 opacity-0 transition-all duration-300 border rounded px-3 py-2',
            placeholder: 'Lien YouTube'
        }
    }) }}


									</div>
								</div>

								<div class="text-[#f8285a] text-sm">
									{{ form_errors(videoForm.url) }}
								</div>
							</div>
						{% endfor %}
					</div>

					{# Navigation carousel #}
					<button type="button" id="prev" class="absolute left-2 top-1/2 -translate-y-1/2 bg-white p-2 rounded-full shadow z-10">
						<i class="bi bi-chevron-left"></i>
					</button>
					<button type="button" id="next" class="absolute right-2 top-1/2 -translate-y-1/2 bg-white p-2 rounded-full shadow z-10">
						<i class="bi bi-chevron-right"></i>
					</button>

					{# Boutons ajout #}
					<div class="flex justify-center gap-4 mt-[42px] mb-[42px]">
						<button type="button" id="add-image" class="px-4 py-2 bg-[#e9f3ff] text-[#1b84ff] rounded hover:text-white hover:bg-[#056ee9]">
							<i class="bi bi-plus-square-fill"></i>
							Ajouter une image
						</button>
						<button type="button" id="add-video" class="px-4 py-2 bg-[#e9f3ff] text-[#1b84ff] rounded hover:text-white hover:bg-[#056ee9]">
							<i class="bi bi-plus-square-fill "></i>
							Ajouter une vidéo
						</button>
					</div>
				</div>

				<!-- Title, Content, Category -->
				<div class="px-4 md:px-8 lg:px-24">
					<div class="mb-4">
						{{ form_widget(form.title, {
    attr: {
        class: 'w-full rounded-xl border border-[#1b84ff]  bg-white px-4 py-2',
     
    }
}) }}
						<div class="text-red-500 text-sm">{{ form_errors(form.title) }}</div>
					</div>
					<div class="mb-4">
						{{ form_widget(form.content, {
    attr: {
        class: 'w-full h-28 sm:h-36 rounded-xl border border-[#1b84ff]  bg-white px-4 py-2 ',
     
    }
}) }}
						<div class="text-red-500 text-sm">{{ form_errors(form.content) }}</div>
					</div>
					<div class="mb-4">
						{{ form_widget(form.category, {
    attr: {
        class: ' rounded-xl border border-[#1b84ff]  bg-white px-4 py-2  px-4 pr-10 py-2 ',
     
    }
}) }}
						<div class="text-red-500 text-sm">{{ form_errors(form.category) }}</div>
					</div>
					<div class="flex justify-end">
						<button class="px-4 py-2 bg-[#1b84ff] text-white rounded hover:bg-[#056ee9]">Modifier</button>
					</div>
				</div>

				{{ form_end(form) }}
			</div>
		</div>
	</section>
{% endblock %}

{% block javascripts %}
	{{ parent() }}
	<script src="{{ asset('js/featured-image.js') }}"></script>
	<script src="{{ asset('js/carousel.js') }}"></script>
{% endblock %}


<section
	class="relative bg-[#D9E2F1] pb-12">

	<!-- Hero image -->
	<div class="absolute inset-0">
		<img src="{{ asset('assets/images/image-cover.jpg') }}" alt="Hero" class="w-full h-[400px] sm:h-[500px] md:h-[600px] object-cover brightness-75">
		<div class="absolute inset-0 bg-gradient-to-b from-transparent to-white/80"></div>
	</div>

	<!-- Centered card -->
	<div class="relative z-10 container mx-auto px-4 sm:px-6 md:px-12 lg:px-20 xl:px-32 pt-20 ">
		<div
			class="bg-white rounded-xl shadow-lg max-w-6xl mx-auto overflow-hidden pb-[42px]">
			{# Flash messages #}
			{% for label, messages in app.flashes %}
				{% for message in messages %}
					<div class="p-4 mb-4 rounded bg-green-100 text-green-800">
						{{ message }}
					</div>
				{% endfor %}
			{% endfor %}
			{{ form_start(form, { attr: { novalidate:'novalidate', enctype:'multipart/form-data' } }) }}

			<!-- HERO IMAGE UPLOAD -->
			<!-- HERO IMAGE UPLOAD -->
				<div
				class="mb-[42px]"> <!-- Featured Image Container -->
				<div
					id="image-container" class="w-full aspect-video border-2  rounded-t-xl flex items-center justify-center cursor-pointer overflow-hidden relative transition-all duration-300 hover:border-blue-400 hover:bg-gray-50 bg-[#E5E6EA]">

					{# Aperçu image #}
					<img
					id="image-preview" class="absolute inset-0 w-full h-full object-cover object-center opacity-0 transition-opacity duration-300"/>

					{# Placeholder #}
					<span id="image-placeholder" class="absolute text-gray-500 transition-opacity duration-300">
						Cliquez pour ajouter une image
					</span>

					{# Overlay texte/hero (facultatif) #}
					<div class="bg-[#00214D]/50 backdrop-blur-sm p-6 md:p-10 rounded-xl max-w-xl text-center pointer-events-none">
						<h1 class="text-white font-bold uppercase mb-4 text-4xl">Nouvelle figure</h1>
						<p class="text-white text-2xl">Ajouter une figure</p>
					</div>

					{# Champ file Symfony #}
					{{ form_widget(form.featuredImage, { 
            attr: { 
                class: 'absolute w-full h-full opacity-0 cursor-pointer', 
                accept: 'image/png, image/jpeg, image/webp' 
            } 
        }) }}

					{# Actions Edit/Delete #}
					<div class="absolute top-2 right-2 flex gap-2 opacity-0 transition-opacity duration-300" id="image-actions">
						<button type="button" id="edit-image" class="p-2 rounded  bg-[#1b84ff] hover:bg-[#056ee9] text-white">
							<i class="bi bi-pencil"></i>
							<span class="sr-only">Edit</span>
						</button>
						<button type="button" id="delete-image" class="p-2 rounded border-[#f8285a] bg-[#f8285a]  text-white hover:bg-[#d81a48]">
							<i class="bi bi-trash"></i>
							<span class="sr-only">Delete</span>
						</button>
					</div>

					{# Erreur validation #}
					<div id="image-error" class="absolute bottom-2 left-2 text-red-500 text-sm">
						{{ form_errors(form.featuredImage) }}
					</div>

					{# Champ caché suppression (backend) #}
					{{ form_widget(form.deleteFeaturedImage) }}
				</div>
			</div>


			{# Prototypes Symfony pour ajout dynamique #}
			{% set imagePrototype %}
			<div class="media-item media-image flex-shrink-0 w-40 snap-start relative">
				<div class="mb-3 w-full aspect-video rounded overflow-hidden border relative">
					<img class="image-preview hidden w-full h-full object-cover object-center"/>
					<div class="image-placeholder absolute inset-0 bg-gray-100 flex items-center justify-center rounded border">
						<i class="bi bi-image text-2xl text-gray-400"></i>
					</div>
				</div>
				<input type="hidden" class="removed-image" name="removed_images[]">
				<div class="media-actions flex justify-end gap-2 mt-2">
					<div class="flex flex-row-reverse items-center gap-2">
						<button type="button" class="remove-item p-2 rounded border  border-[#f8285a] bg-white  text-[#f8285a] hover:bg-[#f8285a] hover:text-white">
							<i class="bi bi-x-square-fill"></i>
						</button>
						<button type="button" class="item-add p-2 rounded border border-[#1b84ff]  bg-white hover:bg-[#1b84ff] hover:text-white text-[#1b84ff]  transition">
							<i class="bi bi-plus-square-fill"></i>
						</button>
						<button type="button" class="item-edit p-2  rounded  bg-[#e9f3ff] hover:bg-[#1b84ff] hover:text-white text-[#1b84ff] transition hidden ">
							<i class="bi bi-plus-square-fill"></i>
						</button>
						<button type="button" class="item-close p-2 rounded border border-[#f6c000]  bg-white hover:bg-[#f6c000] hover:text-white text-[#f6c000] transition hidden">
							<i class="bi bi-eye-slash-fill"></i>
						</button>
						{{ form_widget(form.images.vars.prototype.file, {
    attr: {
        class: 'item-input h-10 w-0 opacity-0 transition-all duration-300 border rounded px-3 text-sm file:h-full file:border-0 file:bg-transparent',
        accept: 'image/png,image/jpeg,image/webp'
    }
}) }}

					</div>
				</div>

				<div class="text-[#f8285a] text-sm">
					{{ form_errors(form.images.vars.prototype.file) }}
				</div>

			</div>
			{% endset %}

			{% set videoPrototype %}
			<div class="media-item media-video flex-shrink-0 w-40 snap-start relative ">
				<div class="mb-3 w-full aspect-video rounded border relative">
					<iframe class="hidden w-full h-full rounded border" frameborder="0" allowfullscreen></iframe>
					<div class="video-placeholder absolute inset-0 bg-gray-100 flex items-center justify-center rounded border">
						<i class="bi bi-play-btn text-3xl text-gray-400"></i>
					</div>
				</div>
				<input type="hidden" class="removed-video" name="removed_videos[]">
				<div class="media-actions flex justify-end gap-2 mt-2">
					<div class="flex flex-row-reverse items-center gap-2">
						<button type="button" class="remove-item p-2 rounded border  border-[#f8285a] bg-white  text-[#f8285a] hover:bg-[#f8285a] hover:text-white">
							<i class="bi bi-x-square-fill"></i>
						</button>
						<button type="button" class="item-add p-2  rounded border border-[#1b84ff]  bg-white hover:bg-[#1b84ff] hover:text-white text-[#1b84ff]   transition">
							<i class="bi bi-plus-square-fill"></i>
						</button>
						<button type="button" class="item-edit p-2  rounded border border-[#1b84ff]  bg-white hover:bg-[#1b84ff] hover:text-white text-[#1b84ff] transition hidden">
							<i class="bi bi-plus-square-fill"></i>
						</button>
						<button type="button" class="item-close p-2 rounded border border-[#f6c000]  bg-white hover:bg-[#f6c000] hover:text-white text-[#f6c000] transition hidden">
							<i class="bi bi-eye-slash-fill"></i>
						</button>
						{{ form_widget(form.videos.vars.prototype.url, {
                                attr: { class: 'item-input w-0 opacity-0 transition-all duration-300 border rounded px-3 py-2', placeholder: 'Lien YouTube' }
                            }) }}
					</div>
				</div>

				<div class="text-[#f8285a] text-sm">
					{{ form_errors(form.videos.vars.prototype.url) }}
				</div>
			</div>
			{% endset %}

			<div id="image-prototype" class="hidden" data-prototype="{{ imagePrototype|e('html_attr') }}"></div>
			<div id="video-prototype" class="hidden" data-prototype="{{ videoPrototype|e('html_attr') }}"></div>

			{# ----------------- CAROUSEL ----------------- #}
			<div class="relative w-full px-4 md:px-8 lg:px-8 overflow-hidden ">
				<div
					id="media-wrapper" class="flex gap-4 overflow-x-auto scroll-smooth snap-x snap-mandatory">
					{# Images existantes #}
					{% for imageForm in form.images %}
						<div class="media-item media-image flex-shrink-0 w-40 snap-start relative ">
							{% if imageForm.vars.data and imageForm.vars.data.picture %}
								<div class="mb-3 w-full aspect-video rounded overflow-hidden border">
									<img src="{{ asset('uploads/tricks/' ~ imageForm.vars.data.picture) }}" class="w-full h-full object-cover" data-filename="{{ imageForm.vars.data.picture }}">
								</div>
							{% else %}
								<div class="image-placeholder bg-gray-100 w-full aspect-video flex items-center justify-center rounded border mb-3">
									<i class="bi bi-image text-2xl text-gray-400"></i>
								</div>
							{% endif %}
							<input type="hidden" class="removed-image" name="removed_images[]">


							<div class="media-actions flex justify-end gap-2 mt-2">

								<div class="flex flex-row-reverse items-center gap-2">
									<button type="button" class="remove-item p-2 rounded  border-[#f8285a] bg-[#f8285a]  text-white hover:bg-[#d81a48]">
										<i class="bi bi-trash "></i>
									</button>


									<button type="button" class="item-add p-2 rounded  bg-[#1b84ff] hover:bg-[#056ee9] text-white transition hidden">
										<i class="bi bi-pencil"></i>
									</button>
									<button type="button" class="item-edit p-2 rounded  bg-[#1b84ff] hover:bg-[#056ee9] text-white transition hidden">
										<i class="bi bi-pencil"></i>
									</button>
									<button type="button" class="item-close p-2 rounded  bg-[#f6c000]  hover:bg-[#dead00] text-white  transition hidden">
										<i class="bi bi-eye-slash"></i>
									</button>

									{{ form_widget(imageForm.file, {
    attr: {
        class: 'item-input h-10 w-0 opacity-0 transition-all duration-300 border rounded px-3 text-sm file:h-full file:border-0 file:bg-transparent',
        accept: 'image/png,image/jpeg,image/webp'
    }
}) }}


								</div>


							</div>


							<div class="text-red-500 text-sm">
								{{ form_errors(imageForm.file) }}
							</div>

						</div>
					{% endfor %}

					{# Vidéos existantes #}
					{% for videoForm in form.videos %}
						<div class="media-item media-video flex-shrink-0 w-40 snap-start relative">
							<div class="video-container mb-3 w-full aspect-video rounded border relative">
								<iframe src="{{ videoForm.vars.data.getEmbedUrl()|default('') }}" class="w-full h-full rounded border" frameborder="0" allowfullscreen></iframe>
								<div class="video-placeholder bg-gray-100 w-full h-full flex items-center justify-center rounded border absolute inset-0 {{ videoForm.vars.data.getEmbedUrl() ? 'hidden' : '' }}">
									<i class="bi bi-play-btn text-3xl text-gray-400"></i>
								</div>
							</div>
							<input type="hidden" class="removed-video" name="removed_videos[]">
							<div class="media-actions flex justify-end gap-2 mt-2">

								<div class="flex flex-row-reverse items-center gap-2">
									<button type="button" class="remove-item p-2 rounded   border-[#f8285a] bg-[#f8285a]  text-white hover:bg-[#d81a48]">
										<i class="bi bi-trash "></i>
									</button>


									<button type="button" class="item-add p-2 rounded   bg-[#1b84ff] hover:bg-[#056ee9] transition hidden">
										<i class="bi bi-pencil  text-white"></i>
									</button>
									<button type="button" class="item-edit p-2 rounded   bg-[#1b84ff]  hover:bg-[#056ee9]  transition hidden">
										<i class="bi bi-pencil text-white"></i>
									</button>
									<button type="button" class="item-close p-2 rounded   bg-[#f6c000]  hover:bg-[#dead00] transition hidden">
										<i class="bi bi-eye-slash text-white"></i>
									</button>

									{{ form_widget(videoForm.url, {
                 attr: {
            class: 'item-input w-0 opacity-0 transition-all duration-300 border rounded px-3 py-2',
            placeholder: 'Lien YouTube'
        }
    }) }}


								</div>
							</div>

							<div class="text-[#f8285a] text-sm">
								{{ form_errors(videoForm.url) }}
							</div>
						</div>
					{% endfor %}
				</div>

				{# Boutons ajout #}
				<div class="flex justify-center gap-4 mt-[42px] mb-[42px]">
					<button type="button" id="add-image" class="px-4 py-2 bg-[#e9f3ff] text-[#1b84ff] rounded hover:text-white hover:bg-[#056ee9]">
						<i class="bi bi-plus-square-fill"></i>
						Ajouter une image
					</button>
					<button type="button" id="add-video" class="px-4 py-2 bg-[#e9f3ff] text-[#1b84ff] rounded hover:text-white hover:bg-[#056ee9]">
						<i class="bi bi-plus-square-fill "></i>
						Ajouter une vidéo
					</button>
				</div>
			</div>

			<!-- Title, Content, Category -->
			<div class="px-4 md:px-8 lg:px-24">
				<div class="mb-4">
					{{ form_widget(form.title, {
    attr: {
        class: 'w-full rounded-xl border border-[#1b84ff]  bg-white px-4 py-2',
     
    }
}) }}
					<div class="text-red-500 text-sm">{{ form_errors(form.title) }}</div>
				</div>
				<div class="mb-4">
					{{ form_widget(form.content, {
    attr: {
        class: 'w-full h-28 sm:h-36 rounded-xl border border-[#1b84ff]  bg-white px-4 py-2 ',
     
    }
}) }}
					<div class="text-red-500 text-sm">{{ form_errors(form.content) }}</div>
				</div>
				<div class="mb-4">
					{{ form_widget(form.category, {
    attr: {
        class: ' rounded-xl border border-[#1b84ff]  bg-white px-4 py-2  px-4 pr-10 py-2 ',
     
    }
}) }}
					<div class="text-red-500 text-sm">{{ form_errors(form.category) }}</div>
				</div>
				<div class="flex justify-end">
					<button class="px-4 py-2 bg-[#1b84ff] text-white rounded hover:bg-[#056ee9]">Ajouter</button>
				</div>
			</div>

			{{ form_end(form) }}

		</div>
	</div>
</section>


$avatarImageFile = $form->get('avatar')->getData();
$deleteFeatured    = $form->get('deleteFeaturedImage')->getData() ?? 0;


if ($avatarImageFile) {
                $trick->setFeaturedImage($imageUploader->upload($avatarImageFile));
            }


<!-- Featured Image Container -->
<div class="mb-[42px]">
	<div
		id="image-container" data-existing-image="{{ trick.featuredImage ? asset('uploads/tricks/' ~ trick.featuredImage) : '' }}" class="w-full aspect-video border-2 rounded-t-xl flex items-center justify-center cursor-pointer overflow-hidden relative transition-all duration-300 hover:border-blue-400 hover:bg-gray-50 bg-[#E5E6EA] no-image">

		{# Aperçu image #}
		<img
		id="image-preview" class="absolute inset-0 w-full h-full object-cover object-center opacity-0 transition-opacity duration-300"/>

		{# Placeholder #}
		<span id="image-placeholder" class="absolute text-gray-500 transition-opacity duration-300">
			Cliquez pour ajouter une image
		</span>

		{# Overlay texte/hero (facultatif) #}
		<div class="bg-[#00214D]/50 backdrop-blur-sm p-6 md:p-10 rounded-xl max-w-xl text-center pointer-events-none">
			<h1 class="text-white font-bold uppercase mb-4 text-4xl">{{ trick.title ?: 'Titre du trick' }}</h1>
			<p class="text-white text-2xl">Modifier la figure</p>
		</div>

		{# Champ file Symfony #}
		{{ form_widget(form.featuredImage, {
            attr: {
                class: 'absolute w-full h-full opacity-0 cursor-pointer',
                accept: 'image/png, image/jpeg, image/webp'
            }
        }) }}

		{# Actions Edit/Delete #}
		<div class="absolute top-2 right-2 flex gap-2 opacity-0 transition-opacity duration-300" id="image-actions">
			<button type="button" id="edit-image" class="p-2 rounded bg-[#1b84ff] hover:bg-[#056ee9] text-white">
				<i class="bi bi-pencil"></i>
				<span class="sr-only">Edit</span>
			</button>
			<button type="button" id="delete-image" class="p-2 rounded border-[#f8285a] bg-[#f8285a] text-white hover:bg-[#d81a48]">
				<i class="bi bi-trash"></i>
				<span class="sr-only">Delete</span>
			</button>
		</div>

		{# Erreur validation #}
		<div id="image-error" class="absolute bottom-2 left-2 text-red-500 text-sm">
			{{ form_errors(form.featuredImage) }}
		</div>

		{# Champ caché suppression (backend) #}
		{{ form_widget(form.deleteFeaturedImage, { id: 'delete-featured-image' }) }}
	</div>
</div>

{# JS pour gérer ajout/modif/suppression #}
<script>
	document.addEventListener('DOMContentLoaded', function () {
const container = document.getElementById('image-container');
const input = container.querySelector('input[type="file"]');
const preview = document.getElementById('image-preview');
const placeholder = document.getElementById('image-placeholder');
const actions = document.getElementById('image-actions');
const editBtn = document.getElementById('edit-image');
const deleteBtn = document.getElementById('delete-image');
const deleteHidden = document.getElementById('delete-featured-image');

const updateActions = () => {
const hasImage = preview.src && preview.src.trim() !== '';
if (hasImage) {
container.classList.add('has-image');
container.classList.remove('no-image');
actions.style.opacity = 1;
deleteBtn.style.display = 'inline-flex';
} else {
container.classList.remove('has-image');
container.classList.add('no-image');
actions.style.opacity = 0;
deleteBtn.style.display = 'none';
}
};

// Initialisation
if (container.dataset.existingImage) {
preview.src = container.dataset.existingImage;
preview.style.opacity = 1;
placeholder.style.opacity = 0;
updateActions();
} else {
preview.style.opacity = 0;
placeholder.style.opacity = 1;
updateActions();
}

// Upload image
input.addEventListener('change', function () {
const file = input.files[0];
if (! file) 
return;


if (! file.type.startsWith('image/')) {
alert('Veuillez sélectionner une image');
input.value = '';
return;
}
const reader = new FileReader();
reader.onload = function (e) {
preview.src = e.target.result;
preview.style.opacity = 1;
placeholder.style.opacity = 0;
deleteBtn.style.display = 'inline-flex';
deleteHidden.value = 0;
updateActions();
};
reader.readAsDataURL(file);
});

// Edit → re-sélection
editBtn.addEventListener('click', () => input.click());

// Delete → réinitialiser
deleteBtn.addEventListener('click', function () {
input.value = '';
preview.src = '';
preview.style.opacity = 0;
placeholder.style.opacity = 1;
deleteBtn.style.display = 'none';
container.dataset.existingImage = '';
deleteHidden.value = 1;
updateActions();
});

// Hover EDIT seul si pas d'image
container.addEventListener('mouseenter', () => {
if (! preview.src) 
editBtn.style.opacity = 1;


});
container.addEventListener('mouseleave', () => {
if (! preview.src) 
editBtn.style.opacity = 0;


});
});
</script>


<div
	class="w-full max-w-sm mx-auto mt-10 relative">
	<!-- Preview de l'image -->
	<div class="mb-4 relative">
		<img
		id="preview" src="" alt="Preview" class="w-full h-64 object-cover rounded-lg border border-gray-300 hidden">

		<!-- Boutons sur l'image -->
		<div class="absolute top-2 right-2 flex space-x-2">
			<button type="button" id="edit-image" class="p-2 rounded bg-[#1b84ff] hover:bg-[#056ee9] text-white">
				<i class="bi bi-pencil"></i>
				<span class="sr-only">Edit</span>
			</button>
			<button type="button" id="delete-image" class="p-2 rounded bg-[#f8285a] text-white hover:bg-[#d81a48]">
				<i class="bi bi-trash"></i>
				<span class="sr-only">Delete</span>
			</button>
		</div>
	</div>

	<!-- Input fichier -->
	<label class="block mb-2 text-sm font-medium text-gray-700">Choisir une image</label>
	<input type="file" id="imageInput" accept="image/*" class="block w-full text-sm text-gray-500
	        file:mr-4 file:py-2 file:px-4
	        file:rounded-lg file:border-0
	        file:text-sm file:font-semibold
	        file:bg-blue-50 file:text-blue-700
	        hover:file:bg-blue-100
	        cursor-pointer">
</div>

<script>
	const imageInput = document.getElementById('imageInput');
const preview = document.getElementById('preview');
const deleteBtn = document.getElementById('delete-image');

imageInput.addEventListener('change', () => {
const file = imageInput.files[0];
if (file) {
const reader = new FileReader();
reader.onload = (e) => {
preview.src = e.target.result;
preview.classList.remove('hidden');
};
reader.readAsDataURL(file);
} else {
preview.src = '';
preview.classList.add('hidden');
}
});

deleteBtn.addEventListener('click', () => {
preview.src = '';
preview.classList.add('hidden');
imageInput.value = ''; // Reset input
});
</script>


<div
	class="w-full max-w-sm mx-auto mt-10 relative">
	<!-- Preview de l'image -->
	<div class="mb-4 relative">
		<img
		id="preview" src="" alt="Preview" class="w-full h-64 object-cover rounded-lg border border-gray-300 hidden">

		<!-- Boutons sur l'image -->
		<div class="absolute top-2 right-2 flex space-x-2">
			<button type="button" id="edit-image" class="p-2 rounded bg-[#1b84ff] hover:bg-[#056ee9] text-white">
				<i class="bi bi-pencil"></i>
				<span class="sr-only">Download</span>
			</button>
			<button type="button" id="delete-image" class="p-2 rounded bg-[#f8285a] text-white hover:bg-[#d81a48]">
				<i class="bi bi-trash"></i>
				<span class="sr-only">Delete</span>
			</button>
		</div>
	</div>

	<!-- Input fichier -->
	<label class="block mb-2 text-sm font-medium text-gray-700">Choisir une image</label>
	<input type="file" id="imageInput" accept="image/*" class="block w-full text-sm text-gray-500
	            file:mr-4 file:py-2 file:px-4
	            file:rounded-lg file:border-0
	            file:text-sm file:font-semibold
	            file:bg-blue-50 file:text-blue-700
	            hover:file:bg-blue-100
	            cursor-pointer">
</div>

<script>
	const imageInput = document.getElementById('imageInput');
const preview = document.getElementById('preview');
const editButton = document.getElementById('edit-image');
const deleteButton = document.getElementById('delete-image');

// Afficher l'image choisie
imageInput.addEventListener('change', function () {
const file = this.files[0];
if (file) {
const reader = new FileReader();
reader.onload = function (e) {
preview.src = e.target.result;
preview.classList.remove('hidden'); // Affiche l'image
}
reader.readAsDataURL(file);
}
});

// Télécharger l'image quand on clique sur "edit"
editButton.addEventListener('click', function () {
if (! preview.src) 
return;


const link = document.createElement('a');
link.href = preview.src;
// Utilise le nom original du fichier si disponible
link.download = imageInput.files[0] ? imageInput.files[0].name : 'image.png';
document.body.appendChild(link);
link.click();
document.body.removeChild(link);
});

// Supprimer l'image quand on clique sur "delete"
deleteButton.addEventListener('click', function () {
preview.src = '';
preview.classList.add('hidden');
imageInput.value = ''; // Reset input
});
</script>
